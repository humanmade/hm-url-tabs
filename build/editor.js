(()=>{"use strict";const t=window.wp.i18n,i=window.wp.blockEditor,e=window.wp.components,a=window.wp.hooks,l=window.wp.compose,n=window.wp.data,s=window.ReactJSXRuntime;(0,a.addFilter)("blocks.registerBlockType","hm-url-tabs/add-navigation-link-attributes",function(t,i){return"core/navigation-link"!==i?t:{...t,attributes:{...t.attributes,tabEndpoint:{type:"string",default:"tab"}}}}),(0,a.addFilter)("blocks.registerBlockType","hm-url-tabs/add-tab-visibility-attributes",function(t){return"core/navigation-link"===t.name?t:{...t,attributes:{...t.attributes,hmUrlTabVisibility:{type:"object",default:{condition:"always",endpoint:"tab",tabUrl:""}}}}});const o=(0,l.createHigherOrderComponent)(a=>l=>{const{attributes:o,setAttributes:r,name:b,clientId:c}=l;if(!o||"core/navigation-link"===b)return(0,s.jsx)(a,{...l});const{hmUrlTabVisibility:u={}}=o,{condition:d="always",endpoint:h="tab",tabUrl:m=""}=u,{tabs:p,hasParentWithVisibility:w}=(0,n.useSelect)(t=>{const{getBlocksByName:i,getBlock:e,getBlockParents:a,hasSelectedInnerBlock:l}=t("core/block-editor");return{tabs:i("core/navigation-link").map(t=>e(t)).filter(t=>"tab"===t?.attributes?.kind||"tab-home"===t?.attributes?.kind||"tab-base"===t?.attributes?.kind).map(t=>({label:t.attributes.label||"",url:t.attributes.url||"",endpoint:t.attributes.tabEndpoint||"tab",isHomeTab:"tab-home"===t.attributes.kind,isBaseTab:"tab-base"===t.attributes.kind})),hasParentWithVisibility:a(c).some(t=>{const i=e(t);return i?.attributes?.hmUrlTabVisibility?.condition&&"always"!==i.attributes.hmUrlTabVisibility.condition}),hasSelectedInnerBlock:l(c,!0)}},[c]);if(0===p.length)return(0,s.jsx)(a,{...l});if(w)return(0,s.jsx)(a,{...l});const y=Array.from(new Set(p.map(t=>t.endpoint))),k=y.length>1,v=p.filter(t=>t.endpoint===h);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a,{...l}),(0,s.jsx)(i.InspectorControls,{children:(0,s.jsxs)(e.PanelBody,{title:(0,t.__)("Tab Visibility","hm-url-tabs"),initialOpen:!1,children:[(0,s.jsx)(e.SelectControl,{label:(0,t.__)("Display Condition","hm-url-tabs"),value:d,options:[{label:(0,t.__)("Always show","hm-url-tabs"),value:"always"},{label:(0,t.__)("Show when no endpoint is active","hm-url-tabs"),value:"no-endpoint"},{label:(0,t.__)("Show when endpoint has no value","hm-url-tabs"),value:"endpoint-empty"},{label:(0,t.__)("Show for specific tab","hm-url-tabs"),value:"specific-tab"}],onChange:t=>r({hmUrlTabVisibility:{...u,condition:t}})}),k&&"specific-tab"===d&&(0,s.jsx)(e.SelectControl,{label:(0,t.__)("Endpoint","hm-url-tabs"),value:h,options:y.map(t=>({label:t,value:t})),onChange:t=>r({hmUrlTabVisibility:{...u,endpoint:t}})}),"specific-tab"===d&&(0,s.jsx)(e.SelectControl,{label:(0,t.__)("Tab","hm-url-tabs"),value:m,options:[{label:(0,t.__)("Select a tabâ€¦","hm-url-tabs"),value:""},...v.filter(t=>!t.isHomeTab&&!t.isBaseTab).map(t=>({label:t.label||t.url,value:t.url}))],onChange:t=>r({hmUrlTabVisibility:{...u,tabUrl:t}}),help:(0,t.__)("This block will only be visible when the selected tab is active.","hm-url-tabs")})]})})]})},"withTabVisibilityControls");(0,a.addFilter)("editor.BlockEdit","hm-url-tabs/tab-visibility-controls",o);const r=(0,l.createHigherOrderComponent)(t=>i=>{const{name:e,clientId:a}=i;if("core/navigation-link"===e)return(0,s.jsx)(t,{...i});const{tabs:l,hasVisibility:o}=(0,n.useSelect)(t=>{var i;const{getBlocksByName:e,getBlock:l}=t("core/block-editor"),n=e("core/navigation-link").map(t=>l(t)).filter(t=>"tab"===t?.attributes?.kind||"tab-home"===t?.attributes?.kind||"tab-base"===t?.attributes?.kind),s=l(a),o=s?.attributes?.hmUrlTabVisibility;return{tabs:n,hasVisibility:"always"!==(null!==(i=o?.condition)&&void 0!==i?i:"always")}},[a]);return o&&l.length>0?(0,s.jsx)(t,{...i,className:"wp-block-has-hm-tab-visibility"}):(0,s.jsx)(t,{...i})},"withTabVisibilityIndicator");(0,a.addFilter)("editor.BlockListBlock","hm-url-tabs/tab-visibility-indicator",r)})();